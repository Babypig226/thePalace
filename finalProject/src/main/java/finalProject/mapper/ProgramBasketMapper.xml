<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="finalProject.mapper.ProgramBasketMapper">

	<sql id="basecolumn">
		user_id, program_no
	</sql>
	
	<insert id="cartInsert" parameterType="finalProject.domain.StartEndPageDTO">
		insert into program_basket (<include refid="basecolumn"/>)
		values(#{userId}, #{num})
	</insert>

	<resultMap type="finalProject.domain.ProgramDTO" id="baseProgram">
		<id column="PROGRAM_NO" jdbcType="VARCHAR" property="programNo" />
		<result column="PROGERAM_CATEGORY" jdbcType="VARCHAR" property="programCategory"/>
		<result column="PROGRAM_NAME" jdbcType="VARCHAR" property="programName"/>
		<result column="MAX_COUNT" jdbcType="BIGINT" property="maxCount"/>
		<result column="PROGRAM_CONTENT" jdbcType="VARCHAR" property="programContent"/>
		<result column="PROGRAM_IMAGE" jdbcType="VARCHAR" property="programImage"/>
		<result column="PROGRAM_PRICE" jdbcType="BIGINT" property="programPrice"/>
		<result column="P_OPTION" jdbcType="VARCHAR" property="pOption"/>
		<result column="P_OPTION_PRICE" jdbcType="BIGINT" property="pOptionPrice"/>
		<result column="PROGRAM_ADDR" jdbcType="VARCHAR" property="programAddr"/>
		<result column="PROGRMAM_DATE" jdbcType="TIMESTAMP" property="programDate"/>
		<result column="PROGRAM_REG" jdbcType="TIMESTAMP" property="programReg"/>
		<result column="TEACHER_NO" jdbcType="VARCHAR" property="teacherNo"/>
	</resultMap>

	<resultMap type="finalProject.domain.PgbasketDTO" id="pgbasketMap">
		<association property="cart" javaType="finalProject.domain.PgbasketDTO">
			<id column="PROGRAM_NO" jdbcType="VARCHAR" property="programNo"/>
			<id column="USER_ID" jdbcType="VARCHAR" property="userId"/> 
		</association>
		<collection property="pro" ofType="finalProject.domain.ProgramDTO" resultMap="baseProgram">
			<id column="PROGRAM_NO" jdbcType="VARCHAR" property="programNo" />
			<result column="PROGRAM_NAME" jdbcType="VARCHAR" property="programName"/>
			<result column="PROGRAM_PRICE" jdbcType="BIGINT" property="programPrice"/>
			<result column="TEACHER_NO" jdbcType="VARCHAR" property="teacherNo"/>
		</collection>
	</resultMap>
	
	
	<select id="pgbasketlist" resultMap="pgbasketMap">
		select pb.program_no, p.program_name, p.program_price
		from program_basket pb
		left outer join program  p
		on pb.program_no = p.program_no
		and pb.user_id = '1111'
	</select>
	
</mapper>
